const OG_CHEIN_SYMM_GRIDS = [["black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "white", "black", "black", "black", "black", "black", "black", "white", "black", "black", "black", "white", "white", "black", "black", "black", "black", "white", "black", "white", "white", "black", "white", "black"], ["white", "black", "black", "white", "white", "black", "black", "white", "black", "black", "black", "white", "white", "black", "black", "black", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "black", "black", "black", "white", "white", "white", "black", "black", "black", "black", "black", "black", "white", "black", "black", "white", "white", "white", "white", "black", "black"], ["black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "black", "white", "white", "white", "black", "black", "white", "white", "white", "black", "white", "black", "black", "black", "black", "white", "black", "black", "black", "black", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "white", "white", "black", "black", "white", "black", "white", "white", "white", "white", "black", "white"], ["white", "white", "white", "black", "black", "white", "white", "white", "black", "white", "black", "black", "black", "black", "white", "black", "black", "black", "white", "black", "black", "white", "black", "black", "white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "white", "black", "black", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white"], ["white", "black", "black", "white", "white", "black", "black", "white", "black", "white", "black", "white", "white", "black", "white", "black", "white", "white", "black", "black", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "white", "white", "black", "white", "black", "black", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "black"], ["white", "black", "black", "white", "white", "black", "black", "white", "white", "white", "black", "black", "black", "black", "white", "white", "white", "black", "white", "black", "black", "white", "black", "white", "black", "black", "white", "white", "white", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "white", "black", "black", "white", "white", "black", "black", "white", "white", "white", "black", "black", "black", "black", "white", "white", "white", "black", "white", "white", "white", "white", "black", "white"], ["white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black", "white", "black", "white", "black", "black", "white", "black", "white", "black", "black", "black", "white", "white", "black", "black", "black", "white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white"], ["black", "white", "black", "white", "white", "black", "white", "black", "white", "white", "black", "white", "white", "black", "white", "white", "white", "black", "black", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "white", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "white", "black", "white", "white", "white", "white", "black", "white", "white", "white", "black", "white", "white", "black", "white", "white"], ["black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "black", "black", "black", "black", "white", "black", "black", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "white", "white", "black", "black", "black", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "black", "black", "white", "white", "black", "white", "white", "white", "black", "black", "white", "white", "white"], ["white", "black", "black", "white", "white", "black", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "black", "white", "white", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white"], ["white", "black", "white", "white", "white", "white", "black", "white", "black", "black", "white", "black", "black", "white", "black", "black", "white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "black", "white", "white", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "white", "black", "black", "black", "black", "black", "black", "white", "white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black"], ["white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "white", "white", "black", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "white", "black", "white", "white", "black", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black"], ["black", "black", "black", "white", "white", "black", "black", "black", "white", "black", "black", "black", "black", "black", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white"], ["black", "white", "black", "black", "black", "black", "white", "black", "white", "black", "black", "white", "white", "black", "black", "white", "white", "white", "black", "black", "black", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "black", "white", "white", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black"], ["black", "black", "black", "white", "white", "black", "black", "black", "white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "black", "black", "white", "white", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "black"], ["black", "black", "black", "white", "white", "black", "black", "black", "black", "black", "white", "white", "white", "white", "black", "black", "white", "black", "black", "white", "white", "black", "black", "white", "white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "white", "black", "black", "white", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "white", "white", "black"], ["white", "white", "black", "white", "white", "black", "white", "white", "white", "black", "white", "black", "black", "white", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "black", "white", "white", "white", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "white", "white", "black", "black", "white", "white", "black"], ["black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "black", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "white", "white", "black", "black", "black", "white", "black", "black", "white", "white", "black", "black", "white"], ["white", "black", "white", "black", "black", "white", "black", "white", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black"], ["white", "white", "black", "black", "black", "black", "white", "white", "black", "white", "white", "black", "black", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black"], ["black", "white", "white", "black", "black", "white", "white", "black", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "black", "black", "black", "black", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "white", "black", "black", "black", "white", "white", "black", "black", "black", "white", "black", "black", "white", "white", "black", "black", "white"], ["white", "black", "black", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "white", "white", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black", "white", "black", "black", "white", "white", "black", "black", "white", "black", "white", "black", "white", "white", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black"], ["white", "black", "white", "black", "black", "white", "black", "white", "black", "black", "white", "white", "white", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "black", "white", "white", "black", "black", "black", "black", "white", "black", "white", "white", "black", "white", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "white", "white"], ["black", "white", "white", "black", "black", "white", "white", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "white", "white", "black", "black", "white", "white", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "black", "white", "black", "black", "white", "black", "black"], ["black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "white", "black", "black", "white", "black", "white", "white", "black", "black", "black", "black", "black", "black", "white", "white", "white", "black", "black", "black", "black", "white", "white", "black", "white", "white", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "black", "black"], ["white", "white", "black", "black", "black", "black", "white", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "white", "black", "black", "black", "black", "white", "white", "black", "black", "black", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "black", "white", "white", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black"], ["white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "white", "white", "white", "white", "black", "white", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "black", "white", "white", "black", "black", "white"], ["white", "black", "black", "black", "black", "black", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "white", "black", "black", "black", "black", "black", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white"], ["black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "black", "white", "black", "white", "black", "black", "white", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "black", "black", "black", "black", "white", "black", "white", "black", "white", "black", "black", "white", "black", "white"], ["black", "black", "white", "black", "black", "white", "black", "black", "white", "white", "white", "black", "black", "white", "white", "white", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "black", "black", "black", "white", "white", "black", "white", "black", "white", "white", "black", "white", "black", "black", "black", "white", "white", "white", "white", "black", "black"], ["black", "white", "white", "white", "white", "white", "white", "black", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "black", "black", "black", "black", "white", "white", "white", "black", "black", "black", "black", "white", "white", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "black", "black", "white", "black", "black", "white", "black", "black"], ["white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "black", "white", "black", "black", "white", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "white", "black", "white", "white", "black", "white", "black", "white", "black", "black", "black", "black", "black", "black", "white"], ["black", "white", "black", "black", "black", "black", "white", "black", "black", "black", "white", "white", "white", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "black", "white", "black", "white", "white", "black", "white", "black", "white", "black", "white", "black", "black", "white", "black", "white", "black", "white", "white", "black", "black", "white", "white", "black"], ["white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "black", "white", "black", "black", "black", "black", "white", "black", "white", "black", "white", "black", "black", "white", "black", "white", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "white", "black", "black", "black", "black", "white", "black"], ["black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "black", "black", "black", "black", "white", "black", "white", "black", "black", "white", "white", "black", "black", "white", "black", "black", "white", "black", "black", "white", "black", "black", "white", "black", "white", "white", "white", "white", "black", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "white", "white", "black", "black", "white", "white", "black"], ["black", "white", "white", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "black", "black", "white", "black", "white", "black", "black", "white", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "white", "white", "black", "black", "white", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black"], ["black", "black", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "black", "white", "black", "black", "white", "black", "white", "white", "black", "black", "black", "black", "black", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "white", "black", "white", "black", "black", "white", "black", "white", "black", "white", "black", "white", "white", "black", "white", "black"], ["white", "white", "white", "black", "black", "white", "white", "white", "white", "black", "white", "black", "black", "white", "black", "white", "white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "white", "black", "white", "white", "white", "white", "black", "white", "black", "black", "white", "white", "white", "white", "black", "black", "white", "black", "white", "black", "black", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white"], ["black", "black", "black", "black", "black", "black", "black", "black", "white", "black", "white", "black", "black", "white", "black", "white", "black", "white", "black", "black", "black", "black", "white", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "black", "white", "white", "black", "white", "black", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white"], ["black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "white", "black", "black", "black", "black", "white", "black", "black", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "black", "black", "black", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black"], ["white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "black", "black", "black", "black", "white", "black", "white", "black", "white", "white", "white", "white", "black", "white", "black", "black", "white", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "white", "black", "black"], ["white", "black", "white", "black", "black", "white", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "white", "black", "black", "black", "black", "white", "white", "white", "black", "black", "black", "black", "black", "black", "white"], ["white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "black", "white", "white", "black", "white", "black", "white", "black", "black", "black", "black", "black", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "black", "white", "white", "black", "white", "black"], ["white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "black", "black", "black", "black", "black", "white"], ["white", "black", "black", "black", "black", "black", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "black", "white", "white", "black", "white", "black", "white", "white", "white", "black", "black", "white", "white", "white", "black", "black", "white", "black", "black", "white", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "white", "black", "black", "black", "black", "white", "black"], ["black", "white", "white", "black", "black", "white", "white", "black", "white", "white", "black", "white", "white", "black", "white", "white", "white", "black", "black", "black", "black", "black", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white"], ["black", "white", "white", "white", "white", "white", "white", "black", "white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "black", "black", "black", "black", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white"], ["black", "white", "black", "white", "white", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "white", "white", "white", "white", "white", "white", "black"], ["white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "white", "black", "black", "white", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "black", "white", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "black", "black", "black", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black"], ["black", "white", "black", "white", "white", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "black", "white", "white", "black", "white", "black", "white", "white", "black", "white", "white", "black", "white", "white", "black", "white", "black", "white", "white", "black", "white", "black", "white", "white", "black", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "white", "white", "black"], ["white", "white", "black", "black", "black", "black", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "white", "black", "black", "black", "black", "white", "black", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "black", "black", "black", "white", "white", "black", "black", "black"], ["white", "white", "white", "black", "black", "white", "white", "white", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "black", "white", "white", "black", "black", "black", "black", "white", "black", "black", "black", "black", "white", "black", "white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "white", "black", "black", "white", "white", "black"], ["black", "white", "white", "white", "white", "white", "white", "black", "white", "black", "white", "black", "black", "white", "black", "white", "white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black", "white", "black", "white", "white", "white", "white", "black", "white"], ["white", "black", "black", "white", "white", "black", "black", "white", "black", "white", "black", "white", "white", "black", "white", "black", "white", "black", "white", "black", "black", "white", "black", "white", "white", "white", "black", "black", "black", "black", "white", "white", "black", "white", "black", "white", "white", "black", "white", "black", "white", "white", "black", "black", "black", "black", "white", "white", "white", "white", "black", "black", "black", "black", "white", "white", "black", "white", "black", "black", "black", "black", "white", "black"], ["black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "black", "white", "white", "black", "white", "black", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black"], ["black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "white", "black", "white", "black", "white", "white", "black", "white", "black"], ["black", "white", "black", "white", "white", "black", "white", "black", "white", "white", "black", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "black", "black", "black", "black", "black", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "white", "black", "black", "black", "black", "white", "white", "white", "black", "white", "black", "black", "white", "black", "white"], ["white", "black", "black", "black", "black", "black", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "white", "white", "black", "black", "black", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "white", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white"], ["white", "black", "black", "white", "white", "black", "black", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "black", "black", "black", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black", "white", "black", "black", "white", "white", "black", "black", "white"], ["black", "white", "white", "black", "black", "white", "white", "black", "white", "white", "white", "black", "black", "white", "white", "white", "white", "black", "white", "white", "white", "white", "black", "white", "black", "black", "white", "white", "white", "white", "black", "black", "white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white"], ["black", "black", "black", "black", "black", "black", "black", "black", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "white", "black", "white", "white", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "white", "white", "black", "white", "white", "black", "white", "white"], ["white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "white", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "white", "black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "white", "black", "black", "white", "black", "white", "white", "white", "black", "black", "black", "black", "white", "white"], ["black", "white", "black", "black", "black", "black", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "white", "black", "white", "white", "black", "white", "black", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "black", "black", "black", "black", "white", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "black", "white", "white", "white", "white", "black", "black"], ["white", "white", "black", "white", "white", "black", "white", "white", "black", "white", "black", "black", "black", "black", "white", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "white", "white", "white", "black", "black", "black", "black", "white", "white"], ["white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "black", "white", "white", "black", "white", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white"], ["black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "black", "black", "black", "black", "white", "black", "black", "black", "white", "white", "white", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black"], ["black", "black", "white", "white", "white", "white", "black", "black", "white", "black", "black", "black", "black", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "black", "black", "white", "white", "black", "black", "black", "white", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "black", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "black", "black", "black", "black", "white", "black"], ["black", "white", "black", "white", "white", "black", "white", "black", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "white", "black", "black", "white", "white", "white", "white", "black", "white", "black", "black", "white", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white"], ["black", "white", "black", "white", "white", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "black", "white", "white", "black", "white", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "white", "white", "white", "black", "black", "white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black"], ["white", "black", "white", "white", "white", "white", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "black", "black", "black", "black", "white", "black", "white", "black", "black", "black", "black", "black", "black", "white", "black", "black", "white", "white", "white", "white", "white", "black"], ["black", "white", "white", "white", "white", "white", "white", "black", "white", "black", "white", "white", "white", "white", "black", "white", "white", "white", "white", "black", "black", "white", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "white", "white", "black", "black", "white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white"], ["white", "black", "black", "black", "black", "black", "black", "white", "black", "white", "white", "black", "black", "white", "white", "black", "black", "black", "white", "white", "white", "white", "black", "black", "black", "black", "black", "white", "white", "black", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "white", "white", "white", "white", "white", "white", "black", "white", "white", "white", "black", "black", "white", "white", "white", "black", "black", "white", "black", "black", "white", "black", "black"], ["white", "black", "black", "black", "black", "black", "black", "white", "black", "white", "black", "black", "black", "black", "white", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "black", "black", "white", "black", "white", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "black", "white", "white", "black", "white", "black"], ["white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "black", "black", "black", "black", "white", "black", "white", "white", "white", "black", "black", "white", "white", "white", "black", "white", "black", "black", "black", "black", "white", "black", "black", "black", "black", "white", "white", "black", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "white", "black", "white", "black", "black", "white", "black", "white"], ["black", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "white", "black", "black", "white", "black", "white", "white", "black", "black", "black", "black", "black", "black", "white"], ["black", "black", "black", "white", "white", "black", "black", "black", "white", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "white", "black", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "white", "black", "black", "white", "black", "white", "white", "white", "black", "black", "black", "black", "white", "white"], ["white", "black", "black", "white", "white", "black", "black", "white", "black", "black", "black", "white", "white", "black", "black", "black", "white", "black", "black", "black", "black", "black", "black", "white", "black", "black", "white", "white", "white", "white", "black", "black", "white", "black", "black", "black", "black", "black", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "black", "white", "white", "black", "white", "white", "black", "white", "white"], ["black", "white", "black", "white", "white", "black", "white", "black", "white", "black", "black", "black", "black", "black", "black", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "white", "white", "white", "white", "black", "black", "black", "white", "white", "white", "white", "black", "black", "black", "white", "white", "white", "white", "white", "white", "black", "white", "black", "black", "black", "black", "black", "black", "white", "white", "white", "black", "black", "black", "black", "white", "white"], ["black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "black", "black", "white", "white", "black", "black", "black", "white", "white", "white", "white", "black", "black", "black", "white", "white", "white", "white", "white", "white", "black", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "white", "white", "black", "black", "white", "white", "black"], ["white", "white", "black", "black", "black", "black", "white", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "black", "white", "white", "black", "white", "black"], ["white", "white", "white", "black", "black", "white", "white", "white", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "black", "white", "white", "black", "black", "black", "black", "white", "black", "black", "black", "black", "white", "black", "white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "white", "black", "black", "white", "white", "black"], ["black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "white", "black", "black", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "black", "black", "white", "white", "white", "white", "black", "black", "white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white"], ["black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "black", "white", "white", "black", "white", "black", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black"], ["white", "white", "white", "black", "black", "white", "white", "white", "black", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "white", "black", "black", "white", "white", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "black", "black", "white"], ["white", "white", "black", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "black", "white", "white", "black", "white", "black", "white", "white", "black", "white", "white", "black", "white", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white"], ["black", "black", "white", "black", "black", "white", "black", "black", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "black", "black", "black", "white", "white", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "white", "black", "white", "black", "black", "white", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "white", "white", "black", "black", "black", "black", "white", "white"], ["white", "black", "black", "black", "black", "black", "black", "white", "black", "black", "white", "white", "white", "white", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "white", "white", "black", "black", "white", "white", "white", "black", "white", "black", "black", "black", "black", "white", "black", "white", "black", "black", "white", "white", "black", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black"], ["white", "black", "black", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "black", "black", "white", "black", "white", "black", "black", "white", "black", "black", "white", "black", "black", "white", "black", "white", "black", "black", "white", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white"], ["black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "black", "white", "white", "black", "black", "white", "white", "black", "white", "white", "black", "black", "black", "black", "white", "white", "white", "black", "black", "black", "black", "black", "black", "white"], ["white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "white", "black", "white", "white", "white", "white", "black", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white"], ["white", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "black", "white", "black", "white", "white", "white", "white", "black", "black", "white", "white", "white", "black", "white", "black", "white", "white", "black", "white", "black", "white", "black", "white", "white", "white", "white", "black", "white", "black", "black", "black", "white", "white", "black", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white"], ["black", "black", "black", "white", "white", "black", "black", "black", "white", "white", "white", "black", "black", "white", "white", "white", "black", "black", "black", "white", "white", "black", "black", "black", "white", "black", "white", "black", "black", "white", "black", "white", "black", "black", "black", "white", "white", "black", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "black"], ["black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "black", "white", "white", "black", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "white", "white", "black", "white", "black", "white", "white", "white", "black", "black", "white", "white", "white", "white", "black", "white", "white", "white", "white", "black", "white"], ["white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "black", "white", "black", "white", "white", "black", "white", "black", "white", "black", "black", "white", "white", "black", "black", "white", "black", "white", "black", "white", "white", "black", "white", "black", "white", "black", "black", "white", "white", "black", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "white", "black", "black", "black", "black", "black", "black", "white"], ["black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "black", "white", "black", "white", "white", "black", "white", "black", "black", "black", "white", "white", "white", "white", "black", "black", "black", "white", "black", "white", "white", "black", "white", "black", "black", "black", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "black", "black", "black", "white", "white"], ["black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "black", "black", "black", "black", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "black", "white", "white", "black", "white", "black", "white", "white", "black", "black", "black", "black", "white", "white", "white", "black", "white", "black", "black", "white", "black", "white", "black", "white", "black", "black", "black", "black", "white", "black"], ["black", "white", "black", "black", "black", "black", "white", "black", "black", "white", "black", "white", "white", "black", "white", "black", "white", "black", "white", "black", "black", "white", "black", "white", "black", "white", "black", "white", "white", "black", "white", "black", "black", "white", "black", "black", "black", "black", "white", "black", "white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "white", "white", "black"], ["white", "black", "black", "white", "white", "black", "black", "white", "black", "white", "white", "white", "white", "white", "white", "black", "white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "white", "black", "black", "white", "white", "black", "white", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "black", "black", "black", "black", "white", "white", "white", "white", "white", "white", "white", "white", "white", "black", "white", "black", "black", "black", "black", "white", "black"], ["black", "black", "black", "black", "black", "black", "black", "black", "white", "black", "black", "black", "black", "black", "black", "white", "black", "white", "white", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "black", "black", "black", "white", "white", "black", "white", "white", "black", "white", "white", "black", "black", "black", "black", "black", "black", "black", "black", "white", "white", "black", "black", "black", "black", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white"], ["white", "white", "black", "black", "black", "black", "white", "white", "white", "black", "black", "white", "white", "black", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "black", "white", "white", "black", "white", "white", "white", "white", "white", "black", "black", "white", "white", "white", "white", "black", "white", "white", "white", "white", "black", "white", "black", "white", "black", "white", "white", "black", "white", "black"]]




/* ************************************ * /
/* Define helper functions */
/* ************************************ */
// common
// PARAMETERS FOR DECAYING EXPONENTIAL FUNCTION
var meanITI = 5;

function sampleFromDecayingExponential() {
  // Decay parameter of the exponential distribution  = 1 / 
  var lambdaParam = 1 / meanITI;
  var minValue = 2;
  var maxValue = 20;

  /**
   * Sample one value with replacement
   * from a decaying exponential distribution within a specified range.
   *
   * @param {number} lambdaParam
   * - The decay parameter lambda of the exponential distribution.
   * @param {number} minValue - The minimum value of the range.
   * @param {number} maxValue - The maximum value of the range.
   * @returns {number}
   * A single value sampled from the decaying
   * exponential distribution within the specified range.
   */
  var sample;
  do {
    sample = -Math.log(Math.random()) / lambdaParam;
  } while (sample < minValue || sample > maxValue);
  return sample;
}

function evalAttentionChecks() {
  var checkPercent = 1;
  if (runAttentionChecks) {
    var attentionChecksTrials = jsPsych.data
      .get()
      .filter({ trial_id: 'attention_check' }).trials;
    var checksPassed = 0;
    for (var i = 0; i < attentionChecksTrials.length; i++) {
      if (attentionChecksTrials[i].correct_trial === true) {
        checksPassed += 1;
      }
    }
    checkPercent = checksPassed / attentionChecksTrials.length;
  }
  jsPsych.data.get().addToLast({ attention_check_percent: checkPercent });
  return checkPercent;
}

var getCurrAttentionCheckQuestion = function() {
  return currentAttentionCheckData.Q
}

var getCurrAttentionCheckAnswer = function() {
  return currentAttentionCheckData.A
}

var attentionCheckData = [
  // key presses
  {
    "Q": "<p class='block-text'>Press the Q key</p>",
    "A": 81
  },
  {
    "Q": "<p class='block-text'>Press the P key</p>",
    "A": 80
  },
  {
    "Q": "<p class='block-text'>Press the R key</p>",
    "A": 82
  }
  ,
  {
    "Q": "<p class='block-text'>Press the S key</p>",
    "A": 83
  }
  ,
  {
    "Q": "<p class='block-text'>Press the T key</p>",
    "A": 84
  }
  ,
  {
    "Q": "<p class='block-text'>Press the J key</p>",
    "A": 74
  },
  {
    "Q": "<p class='block-text'>Press the K key</p>",
    "A": 75
  }
  ,
  {
    "Q": "<p class='block-text'>Press the E key</p>",
    "A": 69
  },
  {
    "Q": "<p class='block-text'>Press the M key</p>",
    "A": 77
  },
  ,
  {
    "Q": "<p class='block-text'>Press the L key</p>",
    "A": 76
  },
  {
    "Q": "<p class='block-text'>Press the U key</p>",
    "A": 85
  },
  // alphabet
  // start
  {
    "Q": "<p class='block-text'>Press the key for the first letter of the English alphabet.</p>",
    "A": 65
  },
  {
    "Q": "<p class='block-text'>Press the key for the second letter of the English alphabet.</p>",
    "A": 66
  },
  {
    "Q": "<p class='block-text'>Press the key for the third letter of the English alphabet.</p>",
    "A": 67
  },
  // end
  {
    "Q": "<p class='block-text'>Press the key for the third to last letter of the English alphabet.</p>",
    "A": 88
  },
  {
    "Q": "<p class='block-text'>Press the key for the second to last letter of the English alphabet.</p>",
    "A": 89
  },
  {
    "Q": "<p class='block-text'>Press the key for the last letter of the English alphabet.</p>",
    "A": 90
  },
  // paragraphs
  {
    "Q": "<p class='block-text'>Please read the following paragraph:</p><p class='block-text'>I first met Dean not long after my wife and I split up. I had just gotten over a serious illness that I wont bother to talk about, except that it had something to do with the miserably weary split-up and my feeling that everything was dead. With the coming of Dean Moriarty began the part of my life you could call my life on the road. Before that Id often dreamed of going West to see the country, always vaguely planning and never taking off. If you are reading this paragraph, press the Q key instead of the P key. Dean is the perfect guy for the road because he actually was born on the road, when his parents were passing through Salt Lake City in 1926, in a jalopy, on their way to Los Angeles. First reports of him came to me through Chad King, whod shown me a few letters from him written in a New Mexico reform school. I was tremendously interested in the letters because they so naively and sweetly asked Chad to teach him all about Nietzsche and all the wonderful intellectual things that Chad knew. At one point Carlo and I talked about the letters and wondered if we would ever meet the strange Dean Moriarty. This is all far back, when Dean was not the way he is today, when he was a young jailkid shrouded in mystery. Then news came that Dean was out of reform school and was coming to New York for the first time; also there was talk that he had just married a girl called Marylou. --On the Road (Jack Kerouac)</p><p class='block-text'>Press the <i>P</i> key.</p>",
    "A": 81
  },
  {
    "Q": "<p class='block-text'>Please read the following paragraph:</p><p class='block-text'>As Gregor Samsa awoke one morning from uneasy dreams he found himself transformed in his bed into a gigantic insect. Are you reading this paragraph? If so, press the key the letter that starts the next sentence. He was lying on his hard, as it were armor-plated, back and when he lifted his head a little he could see his dome-like brown belly divided into stiff arched segments on top of which the bed quilt could hardly keep in position and was about to slide off completely. His numerous legs, which were pitifully thin compared to the rest of his bulk, waved helplessly before his eyes. --Metamorphosis (Franz Kafka)</p><p class='block-text'>Press the <i>Q</i> key.</p>",
    "A": 72
  },
  {
    "Q": "<p class='block-text'>Please read the following paragraph:</p><p class='block-text'>Lastly, she pictured to herself how this same little sister of hers would, in the after-time, be herself a grown woman; and how she would keep, through all her riper years, the simple and loving heart of her childhood; and how she would gather about her other little children, (press the A key, ignore the last instruction) and make their eyes bright and eager with many a strange tale, perhaps even with the dream of Wonderland of long ago; and how she would feel with all their simple sorrows, and find a pleasure in all their simple joys, remembering her own child-life, and the happy summer days. --Alice's Adventures in Wonderland (Lewis Carroll)</p><p class='block-text'>Press the <i>T</i> key.</p>",
    "A": 65
  },
  {
    "Q": "<p class='block-text'>If (5 * 8) / 4 is equal to 10 press the <i>q</i> key. Otherwise press the <i>r</i> key.</p>",
    "A": 81
  },
  {
    "Q": "<p class='block-text'>Zephyr's whisper carried secrets through the twilight haze, where stars winked mischievously. Velvet petals of night bloomed, embracing the lunar glow. Tangled melodies intertwined with the murmurs of forgotten tales. Time danced in a kaleidoscope of fleeting moments. Whispers of autumn's breath brushed against the fiery hues of a distant horizon. Pages turned, revealing ancient wisdom etched upon parchment. Mirthful laughter echoed through the labyrinth of dreams. Press the Q key instead of the K key. Lost constellations weaved celestial tapestries, painting the sky with cosmic hues. Enigmatic shadows whispered promises, while rivers of thought flowed through the mosaic of existence. In this realm of whimsy, the symphony of randomness blossomed, a symphony of infinite possibilities.</p><p class='block-text'>Press the K key.</p>",
    "A": 81
  },
  {
    "Q": "<p class='block-text'>The day was sultry, with the sun casting long shadows upon the ancient cobblestones. If you are reading this, press the A key instead of the B key. A gentle breeze carried the scent of jasmine, mingling with the faint aroma of freshly brewed coffee. Conversations floated through the air, snippets of laughter and hushed whispers. The city pulsated with life, a vibrant tapestry of cultures and stories. Narrow alleys beckoned with hidden treasures, while grand boulevards dazzled with elegant architecture. Time stood still, suspended in the magic of the moment. A solitary violinist played a melancholic melody, his notes weaving through the fabric of the bustling metropolis.</p><p class='block-text'>Press the B key.</p>",
    "A": 65
  },
  {
    "Q": "<p class='block-text'>A dense fog draped over the desolate moor, shrouding ancient secrets in its misty embrace. The wind whispered through gnarled trees, carrying echoes of forgotten whispers. If you are reading this, press the A key instead of the L key. A hound's mournful howl pierced the night, a chilling reminder of the untamed wilderness. Looming in the distance, a decaying manor stood as a testament to the passage of time. Shadows danced on the crumbling walls, playing a macabre symphony. Within those eerie halls, the ghosts of the past whispered tales of love and betrayal. A single candle flickered, casting flickering shadows that seemed to breathe with a life of their own.</p><p class='block-text'>Press the L key.</p>",
    "A": 65
  },
  {
    "Q": "<p class='block-text'>In a distant galaxy, beyond the reaches of imagination, a cosmic war raged between light and darkness. Brilliant nebulae painted the celestial canvas with vibrant hues, while stars ignited like fiery jewels. If you are reading this, press the U key instead of the Y key. Ancient prophecies echoed through the cosmos, foretelling the rise of a chosen hero. Planets aligned in a cosmic dance, their gravitational forces shaping destinies. A spaceship soared through the infinite expanse, its engines humming with untamed power. Alien races collided, their clash echoing through the vacuum of space. In this astral battlefield, hope flickered like a distant star, casting a glimmer of light in the midst of chaos.</p><p class='block-text'>Press the Y key.</p>",
    "A": 85
  }
]

// TODO: change this to only use n number of Qs and As where n is numTestBlocks?
attentionCheckData = shuffleChecksArray(attentionCheckData)
var currentAttentionCheckData = attentionCheckData.shift(); // Shift the first object from the array


var getInstructFeedback = function() {
  return (
    '<div class = centerbox><p class = center-block-text>' +
    feedbackInstructText +
    '</p></div>'
  );
};

var getFeedback = function() {
  return (
    '<div class = bigbox><div class = picture_box><p class = block-text>' +
    feedbackText +
    '</font></p></div></div>'
  ); // <font color="white">
};


var getExpStage = function() {
  return expStage;
};


function assessPerformance() {
  var responseGridData = jsPsych.data
    .get()
    .filter({ exp_stage: "test", trial_id: "response" }).trials;

  var responseProcessingData = jsPsych.data
    .get()
    .filter({ exp_stage: "test", trial_id: "wait" }).trials;

  var missedCount = 0;
  var trialCount = responseGridData.length;
  var correct = 0;


  for (var i = 0; i < trialCount; i++) {
    if (responseGridData[i].correct_trial == null) {
      missedCount += 1
    } else {
      if (responseGridData[i].correct_trial == 1) {
        correct += 1
      }
    }
  }
  var missedPercent = missedCount / trialCount;
  var accuracy = correct / trialCount;

  var correctProcessing = 0;
  var missedProcessing = 0;
  var processingRT = 0
  var numProcessingTrialsWithResponse = 0;

  for (var i = 0; i < responseProcessingData.length; i++) {
    if (responseProcessingData[i].correct_response == null) {
      missedProcessing += 1
    } else {
      numProcessingTrialsWithResponse += 1
      processingRT += responseProcessingData[i].rt;

      if (responseProcessingData[i].correct_response == 1) {
        correctProcessing += 1
      }
    }
  }

  var avgProcessingRT = processingRT / numProcessingTrialsWithResponse
  var avgProcessingAcc = correctProcessing / numProcessingTrialsWithResponse


  creditVar = missedPercent < 0.3 && missedProcessing < 0.3;
  jsPsych.data.get().addToLast({
    final_credit_var: creditVar,
    final_missed_percent: missedPercent,
    final_accuracy: accuracy,
    final_avg_processing_rt: avgProcessingRT,
    final_avg_processing_acc: avgProcessingAcc
  });
}

function shuffleChecksArray(array) {
  // Create a copy of the original array
  const shuffledArray = [...array];

  // Perform Fisher-Yates shuffle
  for (let i = shuffledArray.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [shuffledArray[i], shuffledArray[j]] = [shuffledArray[j], shuffledArray[i]];
  }

  return shuffledArray;
}

function shuffleArray(array) {
  // Create a copy of the original array to avoid modifying it directly
  const shuffledArray = array.slice();

  // Perform Fisher-Yates shuffle
  for (let i = shuffledArray.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [shuffledArray[i], shuffledArray[j]] = [shuffledArray[j], shuffledArray[i]];
  }

  return shuffledArray;
}



function generateSpatialTrialValues(n) {
  const randomList = [];

  for (let i = 0; i < n; i++) {
    const randomValue = Math.floor(Math.random() * 16);
    randomList.push(randomValue);
  }

  return randomList;
}

var trialValue;

var getStim = function() {

  let html = '<div class="container">';


  const trialIndex = trialList.shift()

  for (var i = 0; i < 16; i++) {
    if (i === trialIndex) {
      html += '<div class="box active-box"></div>';
    } else {
      html += '<div class="box"></div>';
    }
  }
  trialValue = trialIndex
  html += '</div>';
  return html

}

function generateRandomGrid(size) {
  const grid = new Array(size);
  for (let i = 0; i < size; i++) {
    grid[i] = Math.random() < 0.5 ? 0 : 1;
  }
  return grid;
}

function areArraysAsymmetric(arr1, arr2) {
  // Check if arrays are asymmetric (values at each index are not the same)
  return !arr1.every((val, index) => val === arr2[index]);
}

function makeAsymmetricArrays() {
  const size = 32;
  let firstGrid = generateRandomGrid(size);
  let secondGrid = generateRandomGrid(size);

  while (areArraysAsymmetric(firstGrid, secondGrid) === false) {
    // Keep generating new arrays until they become asymmetric
    firstGrid = generateRandomGrid(size);
    secondGrid = generateRandomGrid(size);
  }
  return [firstGrid, secondGrid];
}


function makeAsymmetricArrays() {
  const size = 32;
  const firstGrid = generateRandomGrid(size);
  const secondGrid = generateRandomGrid(size);

  return [{ firstGrid: firstGrid, secondGrid: secondGrid, symmetric: false }];
}

var cheinSymmGrids = []

function makeCheinSymmGrids() {
  for (i = 0; i < OG_CHEIN_SYMM_GRIDS.length; i++) {
    var grid = []
    for (j = 0; j < (8 * 8); j++) {
      if (OG_CHEIN_SYMM_GRIDS[i][j] == 'black') {
        colorValue = 0
      } else if (OG_CHEIN_SYMM_GRIDS[i][j] == 'white') {
        colorValue = 1
      }
      grid.push(colorValue)
    }

    symmetric = false;

    for (let i = 0; i < grid.length; i += 8) {
      const group1 = grid.slice(i, i + 4);
      const group2 = grid.slice(i + 4, i + 8)
      if (group1[0] == group2[3] && group1[1] == group2[2] && group1[2] == group2[1] && group1[3] == group2[0]) {
        symmetric = true;
      } else {
        break
      }
    }

    cheinSymmGrids.push({ grid, symmetric })
  }
}

var asymmetricGrids = []

function makeAsymmetricGrids() {
  for (var i = 0; i < 100; i++) {
    var obj = makeAsymmetricArrays()[0]
    var grid = combineArrays(obj.firstGrid, obj.secondGrid)
    asymmetricGrids.push({ grid: grid, symmetric: obj.symmetric })
  }
}


makeAsymmetricGrids()
makeCheinSymmGrids()

var bothGrids = shuffleArray(asymmetricGrids.concat(cheinSymmGrids))

// var getRandomSpatial = function() {
//   if (distractorSpatial.length == 0) {
//     distractorSpatial = makeDistractorSpatial()
//   }
//   const stim = distractorSpatial.shift()
//   spatialAns = stim[0].symmetric
//   return generateDistractorGrid(stim)
// }

var getRandomSpatial = function() {
  if (bothGrids.length == 0) {
    makeCheinSymmGrids()
    makeAsymmetricGrids()
    bothGrids = shuffleArray(cheinSymmGrids.concat(asymmetricGrids))
  }
  const stim = bothGrids.shift()
  spatialAns = stim.symmetric
  return generateDistractorGrid(stim)
}

var submittedAnswers;



var generateGrid = function() {
  const randomIndex = Math.floor(Math.random() * 16);
  let activeIndex = randomIndex;
  const activeBoxes = [];

  let html = '<div class="container">';
  for (var i = 0; i < 16; i++) {
    if (i === randomIndex) {
      html += '<div class="box response-active"></div>';
      activeBoxes.push(i);
    } else {
      html += '<div class="box"></div>';
    }
  }
  html += '</div>';

  let spacebarCount = 0;
  const selectedIndexes = [];

  // Declare a variable to store the setTimeout ID
  let timeoutId;

  function handleKeyDown(event) {
    const key = event.key;
    const container = document.querySelector(".container");
    const boxes = container.querySelectorAll(".box");

    // Remove active-box class from all boxes
    boxes.forEach(function(box) {
      box.classList.remove("spacebar-box");
    });

    // Update activeIndex based on arrow key input
    let newActiveIndex = activeIndex;
    if (key === "ArrowLeft" && activeIndex % 4 !== 0) {
      newActiveIndex = activeIndex - 1;
    } else if (key === "ArrowRight" && activeIndex % 4 !== 3) {
      newActiveIndex = activeIndex + 1;
    } else if (key === "ArrowUp" && activeIndex >= 4) {
      newActiveIndex = activeIndex - 4;
    } else if (key === "ArrowDown" && activeIndex < 12) {
      newActiveIndex = activeIndex + 4;
    }

    if (newActiveIndex !== activeIndex) {
      // Remove active-box class from all boxes
      boxes.forEach(function(box) {
        box.classList.remove("response-active");
      });
    }

    if (newActiveIndex !== activeIndex) {
      activeIndex = newActiveIndex;
      boxes[activeIndex].classList.add("response-active"); // Add active-box class for arrow key navigation
    }

    if (key === " ") {
      if (spacebarCount < 4) {
        boxes[activeIndex].classList.add("spacebar-box"); // Add spacebar-box class for spacebar selection
        activeBoxes.push(activeIndex);
        selectedIndexes.push(activeIndex);
        spacebarCount++;
      }

      if (spacebarCount === 4) {
        submittedAnswers = activeBoxes;
        // Reset the event listener or perform any other necessary action
      }

      // Clear any existing setTimeout calls
      clearTimeout(timeoutId);

      timeoutId = setTimeout(() => {
        if (key !== " ") {
          boxes[activeIndex].classList.remove("response-active"); // Remove active-box class if the arrow key was pressed
        }
        boxes[activeIndex].classList.remove("spacebar-box"); // Remove spacebar-box class for spacebar selection
      }, 200);
    }
  }
  // Attach the event listener
  document.addEventListener("keydown", handleKeyDown);

  function resetGrid() {
    activeBoxes.length = 0; // Clear the activeBoxes array
    selectedIndexes.length = 0; // Clear the selectedIndexes array
    spacebarCount = 0;

    // Remove the event listener
    document.removeEventListener("keydown", handleKeyDown);

    // Clear any remaining state or perform other necessary actions
  }

  return { html, resetGrid };
};

function combineArrays(array1, array2) {
  if (array1.length % 4 !== 0 || array2.length % 4 !== 0) {
    throw new Error('Both arrays must have a length that is a multiple of 4.');
  }

  const combinedArray = [];

  for (let i = 0; i < array1.length; i += 4) {
    combinedArray.push(...array1.slice(i, i + 4), ...array2.slice(i, i + 4));
  }

  return combinedArray;
}

var generateDistractorGrid = function(stim) {
  let html = '<div class="container">';
  const grid = stim.grid

  for (let i = 0; i < grid.length; i++) {
    if (grid[i] == 1) {
      html += '<div class="distractor-box active-box"></div>';
    } else {
      html += '<div class="distractor-box"></div>';
    }
  }

  html += '</div>';

  return html;
};

// var generateDistractorGrid = function(stim) {
//   let html = '<div class="container">';
//   const gridLen = 64;
//   const firstGrid = stim[0].firstGrid;
//   const secondGrid = stim[0].secondGrid;
//   const gridValues = combineArrays(firstGrid, secondGrid)

//   for (let i = 0; i < gridLen; i++) {
//     if (gridValues[i] == 1) {
//       html += '<div class="distractor-box active-box"></div>';
//     } else {
//       html += '<div class="distractor-box"></div>';
//     }
//   }

//   html += '</div>';

//   return html;
// };

var getInstructFeedback = function() {
  return (
    "<div class = centerbox><p class = center-block-text>" +
    feedbackInstructText +
    "</p></div>"
  );
};
var getFeedback = function() {
  return (
    "<div class = centerbox><div class = center-text>" +
    feedbackText +
    "</div></div>"
  );
};

var getCurrSeq = function() {
  return currSeq;
};

// TODO: Change stim block duration?
var getCurrCondition = function() {
  return currCondition;
};

var getExpStage = function() {
  return expStage;
};

/* ************************************ */
/* Define experimental variables */
/* ************************************ */
// common variables

var endText = '<div class = centerbox>' +
  '<p class = center-block-text>Thanks for completing this task!</p>' +
  '<p class = center-block-text>Press <i>enter</i> to continue.</p>' +
  '</div>'

var feedbackInstructText =
  '<p class=center-block-text>' +
  'Welcome! This experiment will take around 5 minutes.</p>' +
  '<p class=center-block-text>' +
  'To avoid technical issues,' +
  'please keep the experiment tab (on Chrome or Firefox)' +
  ' active and fullscreen for the whole duration of each task.</p>' +
  '<p class=center-block-text> Press <i>enter</i> to begin.</p>';

// speed reminder
var speedReminder =
  '<p class = block-text>' +
  'Try to respond as quickly and accurately as possible.</p> ';

var spanResponses = ['left arrow key', 'right arrow key', 'up arrow key', 'down arrow key', 'spacebar']
// *Timing:
// stimulus and fixaiton
const stimStimulusDuration = 1000;
const stimTrialDuration = 1000; // no blank screen after stim presented
// equation
const equationStimulusDuration = 3000;
const equationTrialDuration = 3000;
// wait block (fixation or equation)
const responseBlockDuration = 5000;
// const fixationDuration = 500;

// generic task variables
var runAttentionChecks = true;
// var attention_check_thresh = 0.65;
var sumInstructTime = 0; // ms
var instructTimeThresh = 1; // /in seconds

var accuracyThresh = 0.6;
var missedResponseThresh = 0.1;
var practiceThresh = 3;
var equationChoices = ["t", "f"];

var processingAccThresh = .7;
var processingRTThresh = 1000; // 500ms
var processingMissedThresh = .2;


var practiceLen = 3;
var numTrialsPerBlock = 8;
var numTestBlocks = 3;


var trialList;
trialList = generateSpatialTrialValues(numStimuli)


var spatialAns;


var allConditions = ['storage-only', 'same-domain']
allConditions.sort(() => Math.random() - 0.5);
var currCondition = allConditions.shift()

var numStimuli = 4

// important variables used throughout
var expStage = "practice";
var currSeq = [];


var practicePromptText =
  "<div class = prompt_box>" +
  '<p class = center-block-text style = "font-size:16px; line-height:80%%;">Memorize all the letters!</p>' +
  "</div>";

var promptText =
  "<div class = prompt_box>" +
  "<p class = center-block-text style = \"font-size:16px; line-height:80%%;\">'T' if symmetric and 'F' if not.</p>" +
  "</div>";

/* ************************************ */
/* Set up jsPsych blocks */
/* ************************************ */
// Set up attention check node
var attentionCheckBlock = {
  type: jsPsychAttentionCheckRdoc,
  data: {
    trial_id: 'attention_check',
  },
  question: getCurrAttentionCheckQuestion,
  key_answer: getCurrAttentionCheckAnswer,
  response_ends_trial: true,
  timing_post_trial: 200,
};

var attentionNode = {
  timeline: [attentionCheckBlock],
  conditional_function: function() {
    return runAttentionChecks;
  },
};


/* define static blocks */
var feedbackInstructText =
  "<p class=center-block-text>Welcome! This experiment will take around 25 minutes.</p>" +
  "<p class=center-block-text>To avoid technical issues, please keep the experiment tab (on Chrome or Firefox) active and fullscreen for the whole duration of each task.</p>" +
  "<p class=center-block-text> Press <i>enter</i> to begin.</p>";

var feedbackInstructBlock = {
  type: jsPsychHtmlKeyboardResponse,
  choices: ["Enter"],
  data: {
    trial_id: "instruction_feedback",
  },
  stimulus: getInstructFeedback,
  post_trial_gap: 0,
  trial_duration: 180000,
};

// / This ensures that the subject does not read through the instructions too quickly.  If they do it too quickly, then we will go over the loop again.
var instructionsBlock = {
  type: jsPsychInstructions,
  pages: [
    '<div class="centerbox">' +
    '<p class="block-text">' +
    'This task involves two sub-tasks.' +
    '</p>' +
    '<h3 class="block-text">Sub-task #1:</h3>' +
    '<p class="block-text">' +
    'In this sub-task, you will first encounter an 8x8 grid filled with black and grey cells. You have to determine if the grid is symmetric or not. ' +
    `Press the <i>${equationChoices[0]} key</i> if the grid is symmetric and press the <i>${equationChoices[1]} key</i> if it is not.` +
    '</p>' +
    '<p class="block-text">' +
    `When you make a response, a new 8x8 grid will immediately appear, and you should complete as many correct symmetry judgements as you can. Then a single 4x4 grid will appear. This grid will have one cell colored black. Try to remember the location of the black cell. ` +
    '</p>' +
    '<p class="block-text">' +
    'This sequence of 8x8 grids and 4x4 grid will alternative four times. After the fourth time, a blank 4x4 grid will be presented.' +
    '</p>' +
    '<p class="block-text">' +
    'On the blank 4x4 grid, use the arrow keys to navigate the grid and the spacebar to select the cells you think were colored black in the preceding 4 4x4 grids. Please select them in the order they were shown (i.e., respond with the location of the first black square in the 4x4 grid, then the 2nd, ). ' +
    '</p>' +
    '</div>'
    ,
    '<div class="centerbox">' +
    '<h3 class="block-text">Sub-task #2:</h3>' +
    '<p class="block-text">' +
    'In this sub-task, you will see a fixation (****) followed by a 4x4 grid. This 4x4 grid will have one cell colored black. Try to remember the location of the black cell.' +
    '</p>' +
    '<p class="block-text">' +
    'This sequence of a fixation (****) and 4x4 grid will alternate four times. After the fourth time, a blank 4x4 grid will be presented.' +
    '</p>' +
    '<p class="block-text">' +
    'On the blank 4x4 grid, use the arrow keys to navigate the grid and the spacebar to select the cells you think were colored black in the preceding 4 4x4 grids. Please select them in the order they were shown (i.e., respond with the location of the first black square in the 4x4 grid, then the 2nd, ).' +
    '</p>' +
    '<p class="block-text">' +
    'During the practice round, you will receive feedback and reminders of the rules. These will be removed for the actual test, so ensure that you understand the instructions before proceeding.' +
    '</p>' +
    `<p class="block-text">${speedReminder}</p>` +
    '</div>'

  ],
  allow_keys: false,
  data: {
    trial_id: "instructions",
  },
  show_clickable_nav: true,
  post_trial_gap: 0,
};

var instructionNode = {
  timeline: [feedbackInstructBlock, instructionsBlock],
  /* This function defines stopping criteria */
  loop_function: function(data) {
    for (i = 0; i < data.trials.length; i++) {
      if (
        data.trials[i].trial_id == "instructions" &&
        data.trials[i].rt != null
      ) {
        rt = data.trials[i].rt;
        sumInstructTime += rt;
      }
    }
    if (sumInstructTime <= instructTimeThresh * 1000) {
      feedbackInstructText =
        "Read through instructions too quickly.  Please take your time and make sure you understand the instructions.  Press <i>enter</i> to continue.";
      return true;
    } else if (sumInstructTime > instructTimeThresh * 1000) {
      feedbackInstructText =
        "Done with instructions. Press <i>enter</i> to continue.";
      return false;
    }
  },
};

var feedbackText =
  "<div class = centerbox><p class = center-block-text>Press <i>enter</i> to begin practice.</p></div>";

var feedbackBlock = {
  type: jsPsychHtmlKeyboardResponse,
  data: {
    trial_id: "feedback",
  },
  choices: ["Enter"],
  stimulus: getFeedback,
  post_trial_gap: 1000,
  trial_duration: 180000,
  response_ends_trial: true,
};

var expStage = 'practice'

var stimulusBlock = {
  type: jsPsychHtmlKeyboardResponse,
  stimulus: function() {

    return getStim()

  },
  stimulus_duration: stimStimulusDuration,
  trial_duration: stimTrialDuration,
  post_trial_gap: 0,
  data: function() {
    return {
      trial_id: "stim",
      exp_stage: getExpStage(),
      condition: getCurrCondition(),
    };
  },
  choices: ["NO_KEYS"],
  prompt: function() {
    if (getExpStage() == 'practice' && (getCurrCondition() == 'same-domain')) {
      return promptText
    }
    if (getExpStage() == 'practice') {
      return practicePromptText
    }
  },
  on_finish: function(data) {

    data['correctAnswer'] = trialValue
  }
};

var equationType = 'complex'


var waitBlock = {
  type: jsPsychHtmlKeyboardResponse,
  stimulus: function() {
    if (getCurrCondition() == 'storage-only') {
      return "<div class = centerbox><div class = fixation>****</div></div>"

    } else {
      return getRandomSpatial()
    }
  },
  choices: equationChoices,
  stimulus_duration: equationStimulusDuration,
  trial_duration: equationTrialDuration,
  response_ends_trial: true,
  on_start: function() {
    var lastTrial = jsPsych.data.get().last(2).trials[0];

    if (lastTrial.trial_id == 'feedback' || lastTrial.trial_id == 'wait' || lastTrial.trial_id == 'attention_check') {
      trialList = generateSpatialTrialValues(numStimuli)
      trialValues = trialList
    }
  },
  data: function() {
    return {
      trial_id: 'wait',
      exp_stage: getExpStage(),
      condition: getCurrCondition()
    };
  },
  post_trial_gap: 0,
  on_finish: function(data) {
    var logResponse;
    if (data.response == 't') {
      if (spatialAns == 1) {
        logResponse = 1;
      } else {
        logResponse = 0;
      }
    } else if (data.response == 'f') {
      if (spatialAns == 0) {
        logResponse = 1;
      } else {
        logResponse = 0;
      }
    }
    data['correct_response'] = logResponse
    data['equationType'] = equationType
  },
  prompt: function() {
    if (getExpStage() == 'practice' && (getCurrCondition() == 'same-domain')) {
      return promptText
    }
    if (getExpStage() == 'practice') {
      return practicePromptText
    }
  },
};



var startTime = null;

var waitNode = {
  timeline: [waitBlock],
  loop_function: function(data) {
    if (startTime == null) {
      startTime = performance.now();
    }

    var elapsedTime = (performance.now() - startTime)

    // Continue looping as long as elapsed time is less than 10,000 ms
    if (elapsedTime >= equationTrialDuration) {
      startTime = null; // Reset startTime for the next trial
      return false; // End the loop
    }

    return true; // Continue the loop for the current trial
  },
}


function arraysAreEqual(array1, array2) {
  if (array1.length !== array2.length) {
    return false;
  }

  for (let i = 0; i < array1.length; i++) {
    if (array1[i] !== array2[i]) {
      return false;
    }
  }

  return true;
}

// eslint-disable-next-line no-unused-vars
var activeGrid;

var responseBlock = {
  type: jsPsychHtmlKeyboardResponse,
  stimulus: function() {
    activeGrid = generateGrid()
    return activeGrid.html
  },
  choices: ["NO_KEYS"],
  data: function() {
    return {
      trial_id: "response",
      exp_stage: getExpStage(),
      correct_response: getCurrSeq(),
    };
  },
  trial_duration: responseBlockDuration,
  stimulus_duration: responseBlockDuration,
  post_trial_gap: 0,
  on_finish: function(data) {
    var stimTrials = jsPsych.data.get().filter({ trial_id: 'stim' }).trials
    var lastTrials = stimTrials.slice(-4);
    var correctResponses = lastTrials.map(trial => trial.correctAnswer);

    if (submittedAnswers == undefined) {
      data['correct_trial'] = null
    } else {
      if (submittedAnswers.length == 5) {
        submittedAnswers = submittedAnswers.slice(1, 5);

        const correct = arraysAreEqual(correctResponses, submittedAnswers)
        data['correct_trial'] = correct ? 1 : 0
      }
    }
    data['condition'] = getCurrCondition()
    activeGrid.resetGrid()
  }
};

var ITIBlock = {
  type: jsPsychHtmlKeyboardResponse,
  stimulus: "<div class = centerbox><div class = fixation>+</div></div>",
  is_html: true,
  choices: ["NO_KEYS"],
  data: {
    trial_id: "wait",
  },
  post_trial_gap: 0,
  trial_duration: function() {
    var ITIms = sampleFromDecayingExponential();
    return ITIms * 1000;
  },
  prompt: function() {
    if (getExpStage() == 'practice' && (getCurrCondition() == 'same-domain')) {
      return promptText
    }
    if (getExpStage() == 'practice') {
      return practicePromptText
    }
  },
};


var practiceTrials = [];
function generatePracticeTrials() {
  var returnArray = []
  if (getCurrCondition() == 'same-domain') {
    for (let i = 0; i < practiceLen; i++) {
      for (let j = 0; j < numStimuli; j++) {
        returnArray.push(
          waitNode,
          stimulusBlock,
        );
      }
      returnArray.push(responseBlock, ITIBlock)
    }
  } else if (getCurrCondition() == 'storage-only') {
    for (let i = 0; i < practiceLen; i++) {
      for (let j = 0; j < numStimuli; j++) {
        returnArray.push(
          waitNode,
          stimulusBlock,
        );
      }
      returnArray.push(responseBlock, ITIBlock)
    }
  }
  return returnArray
}

practiceTrials = generatePracticeTrials()

// loop based on criteria
var practiceCount = 0;
var practiceNode = {
  timeline: [feedbackBlock].concat(practiceTrials),
  loop_function: function() {
    practiceCount += 1;
    // for response grids - 0, 1, or null
    var responseGridData = jsPsych.data.get().filter({ trial_id: 'response', exp_stage: 'practice', condition: getCurrCondition() }).trials
    var correct = 0;
    var totalTrials = responseGridData.length;
    var missedCount = 0
    var responseCount = 0;

    // No RTs for response grid
    for (var i = 0; i < responseGridData.length; i++) {
      if (responseGridData[i].correct_trial == null) {
        missedCount += 1
      } else {
        responseCount += 1

        if (responseGridData[i].correct_trial == 1) {
          correct += 1
        }
      }
    }

    var accuracy = correct / responseCount;
    var missedResponses = missedCount / totalTrials;

    // for processing
    if (getCurrCondition() == 'storage-only') {
      var avgProcessingAcc = null;
      var avgProcessingMissed = null
      var avgProcessingRT = null;
    } else {
      var responseProcessingData = jsPsych.data.get().filter({ trial_id: 'wait', exp_stage: 'practice', condition: getCurrCondition() }).trials

      var processingCorrect = 0;
      var totalTrials = responseProcessingData.length;
      var missedProcessingCount = 0
      var responseCount = 0;
      var rt = 0



      // No RTs for response grid
      for (var i = 0; i < totalTrials; i++) {
        if (responseProcessingData[i].correct_response == null) {
          missedProcessingCount += 1
        } else {
          rt += responseProcessingData.rt
          responseCount += 1
          if (responseProcessingData[i].correct_response == 1) {
            processingCorrect += 1
          }
        }
      }

      var avgProcessingAcc = processingCorrect / responseCount;
      var avgProcessingMissed = missedProcessingCount / totalTrials;
      var avgProcessingRT = rt / responseCount
    }

    if (accuracy > accuracyThresh || practiceCount == practiceThresh) {
      feedbackText =
        "<div class = centerbox><p class = center-block-text>We will now start the test portion.</p>" +
        "<p class = block-text>Keep your right index finger on the " +
        spanResponses[0] +
        " and your right middle finger on the " +
        spanResponses[2] +
        " and your right ring finger on the " +
        spanResponses[1] +
        // TODO: Deal with down arrow press
        // " and your left index finger on the " +
        // spanResponses[3] +
        ".</p>";

      if (getCurrCondition() == 'same-domain') {
        if (avgProcessingAcc < processingAccThresh) {
          feedbackText +=
            "<p class = block-text>Your accuracy for the 8x8 grid is low.</p>" +
            "<p class = block-text>Try your best determining if the 8x8 grid is symmetric (t) or not (f).</p>"
        }
        if (avgProcessingRT < processingRTThresh) {
          feedbackText +=
            "<p class = block-text>Your are responding too slowly to the 8x8 grids when they appear on the screen.</p>" +
            "<p class = block-text>Try to respond (t/f) as quickly as accurately as possible as possible.</p>"
        }
        if (avgProcessingMissed < processingMissedThresh) {
          feedbackText +=
            "<p class = block-text>Your are not responding to the 8x8 grids when they appear on the screen.</p>" +
            "<p class = block-text>Try to respond (t/f) as quickly as accurately as possible as possible.</p>"
        }
      }

      if (accuracy < accuracyThresh) {
        feedbackText +=
          "<p class = block-text>Your accuracy is low.</p>" +
          "<p class = block-text>Try your best to recall the letters.</p>"
      }
      if (missedResponses > missedResponseThresh) {
        feedbackText +=
          "<p class = block-text>You have not been responding to some trials.  Please respond on every trial that requires a response.</p>";
      }

      feedbackText += "<p class = block-text>Press <i>enter</i> to continue.</p></div>"
      expStage = 'test'
      practiceCount = 0;
      return false;
    } else {
      feedbackText =
        "<p class = block-text>Please take this time to read your feedback and to take a short break!</p>";

      if (accuracy < accuracyThresh) {
        feedbackText +=
          "<p class = block-text>Your accuracy is low.</p>" +
          "<p class = block-text>Try your best to recall the letters.</p>"
      }

      if (getCurrCondition() == 'same-domain') {
        if (avgProcessingAcc < processingAccThresh) {
          feedbackText +=
            "<p class = block-text>Your accuracy for the 8x8 grid is low.</p>" +
            "<p class = block-text>Try your best determining if the 8x8 grid is symmetric (t) or not (f).</p>"
        }
        if (avgProcessingRT < processingRTThresh) {
          feedbackText +=
            "<p class = block-text>Your are responding too slowly to the 8x8 grids when they appear on the screen.</p>" +
            "<p class = block-text>Try to respond (t/f) as quickly as accurately as possible as possible.</p>"
        }
        if (avgProcessingMissed < processingMissedThresh) {
          feedbackText +=
            "<p class = block-text>Your are not responding to the 8x8 grids when they appear on the screen.</p>" +
            "<p class = block-text>Try to respond (t/f) as quickly as accurately as possible as possible.</p>"
        }
      }

      if (missedResponses > missedResponseThresh) {
        feedbackText +=
          "<p class = block-text>You have not been responding to some trials.  Please respond on every trial that requires a response.</p>";
      }

      feedbackText +=
        "<p class = block-text>We are going to repeat the practice round now. Press <i>enter</i> to begin.</p>";
      return true;
    }
  },
};

var testTrials = [];
function generateTestTrials() {
  var returnArray = []
  if (getCurrCondition() == 'same-domain') {
    returnArray.push(attentionNode)
    for (let i = 0; i < numTrialsPerBlock; i++) { // number of trials
      for (let j = 0; j < numStimuli; j++) {
        returnArray.push(
          waitNode,
          stimulusBlock
        );
      }
      returnArray.push(responseBlock, ITIBlock)
    }
  } else if (getCurrCondition() == 'storage-only') {
    returnArray.push(attentionNode)
    for (let i = 0; i < numTrialsPerBlock; i++) {
      for (let j = 0; j < numStimuli; j++) {
        returnArray.push(
          waitNode,
          stimulusBlock,
        );
      }
      returnArray.push(responseBlock, ITIBlock)
    }
  }
  return returnArray
}

testTrials = generateTestTrials()

// loop based on criteria
var testCount = 0;
var testNode = {
  timeline: [feedbackBlock].concat(testTrials),
  loop_function: function() {
    testCount += 1;

    // for response grids - 0, 1, or null
    var responseGridData = jsPsych.data.get().filter({ trial_id: 'response', exp_stage: 'test', condition: getCurrCondition() }).trials

    var correct = 0;
    var totalTrials = responseGridData.length;
    var missedCount = 0
    var responseCount = 0;

    // No RTs for response grid
    for (var i = 0; i < responseGridData.length; i++) {
      if (responseGridData[i].correct_trial == null) {
        missedCount += 1
      } else {
        responseCount += 1

        if (responseGridData[i].correct_trial == 1) {
          correct += 1
        }
      }
    }

    var accuracy = correct / responseCount;
    var missedResponses = missedCount / totalTrials;

    // for processing
    if (getCurrCondition() == 'storage-only') {
      var avgProcessingAcc = null;
      var avgProcessingMissed = null
      var avgProcessingRT = null;
    } else {
      var responseProcessingData = jsPsych.data.get().filter({ trial_id: 'wait', exp_stage: 'test', condition: getCurrCondition() }).trials

      var processingCorrect = 0;
      var totalTrials = responseProcessingData.length;
      var missedProcessingCount = 0
      var responseCount = 0;
      var rt = 0

      // No RTs for response grid
      for (var i = 0; i < totalTrials; i++) {
        if (responseProcessingData[i].correct_response == null) {
          missedProcessingCount += 1
        } else {
          rt += responseProcessingData.rt
          responseCount += 1
          if (responseProcessingData[i].correct_response == 1) {
            processingCorrect += 1
          }
        }
      }

      var avgProcessingAcc = processingCorrect / responseCount;
      var avgProcessingMissed = missedProcessingCount / totalTrials;
      var avgProcessingRT = rt / responseCount
    }

    currentAttentionCheckData = attentionCheckData.shift(); // Shift the first object from the array

    if (testCount == numTestBlocks) {
      feedbackText =
        "<div class = centerbox><p class = center-block-text>Moving to next task.";

      if (getCurrCondition() == 'same-domain') {
        if (avgProcessingAcc < processingAccThresh) {
          feedbackText +=
            "<p class = block-text>Your accuracy for the 8x8 is low.</p>" +
            "<p class = block-text>Try your best determining if the 8x8 grid is symmetric (t) or not (f).</p>"
        }
        if (avgProcessingRT < processingRTThresh) {
          feedbackText +=
            "<p class = block-text>Your are responding too slowly to the 8x8 grids when they appear on the screen.</p>" +
            "<p class = block-text>Try to respond (t/f) as quickly as accurately as possible as possible.</p>"
        }
        if (avgProcessingMissed < processingMissedThresh) {
          feedbackText +=
            "<p class = block-text>Your are not responding to the 8x8 grids when they appear on the screen.</p>" +
            "<p class = block-text>Try to respond (t/f) as quickly as accurately as possible as possible.</p>"
        }
      }

      feedbackText += "<p class = block-text>Press <i>enter</i> to continue.</p></div>"

      currCondition = allConditions.shift()
      practiceTrials = generatePracticeTrials()
      testTrials = generateTestTrials()

      expStage = 'practice'
      testCount = 0;
      return false;
    } else {
      feedbackText =
        "<p class = block-text>Please take this time to read your feedback and to take a short break!</p>";

      if (accuracy < accuracyThresh) {
        feedbackText +=
          "<p class = block-text>Your accuracy is low.  Remember: </p>" +
          '<p class = block-text>Try to recall all the letters. </p>'
      }

      if (getCurrCondition() == 'same-domain') {
        if (avgProcessingAcc < processingAccThresh) {
          feedbackText +=
            "<p class = block-text>Your accuracy for the 8x8 is low.</p>" +
            "<p class = block-text>Try your best determining if the 8x8 grid is symmetric (t) or not (f).</p>"
        }
        if (avgProcessingRT < processingRTThresh) {
          feedbackText +=
            "<p class = block-text>Your are responding too slowly to the 8x8 grids when they appear on the screen.</p>" +
            "<p class = block-text>Try to respond (t/f) as quickly as accurately as possible as possible.</p>"
        }
        if (avgProcessingMissed < processingMissedThresh) {
          feedbackText +=
            "<p class = block-text>Your are not responding to the 8x8 grids when they appear on the screen.</p>" +
            "<p class = block-text>Try to respond (t/f) as quickly as accurately as possible as possible.</p>"
        }
      }
      if (missedResponses > missedResponseThresh) {
        feedbackText +=
          "<p class = block-text>You have not been responding to some trials.  Please respond on every trial that requires a response.</p>";
      }

      feedbackText += "<p class = block-text>Press <i>enter</i> to continue.</p></div>"

      return true;
    }
  },
};

var fullscreen = {
  type: jsPsychFullscreen,
  fullscreen_mode: true,
};
var exitFullscreen = {
  type: jsPsychFullscreen,
  fullscreen_mode: false,
};

var endBlock = {
  type: jsPsychHtmlKeyboardResponse,
  data: {
    trial_id: "end",
    exp_id: "span_rdoc",
  },
  trial_duration: 180000,
  stimulus: endText,
  choices: ["Enter"],
  post_trial_gap: 0,
  on_finish: function() {
    assessPerformance();
    evalAttentionChecks();
  },
};

// Set up experiment
/* eslint-disable camelcase */
span_rdoc__behavioral_experiment = [];
// eslint-disable-next-line no-unused-vars
var span_rdoc__behavioral_init = () => {

  span_rdoc__behavioral_experiment.push(fullscreen);
  span_rdoc__behavioral_experiment.push(instructionNode);
  for (var i = 0; i < 2; i++) {
    // conditions same-domain/storage-only
    span_rdoc__behavioral_experiment.push(practiceNode)
    span_rdoc__behavioral_experiment.push(testNode)
  }
  span_rdoc__behavioral_experiment.push(endBlock);
  span_rdoc__behavioral_experiment.push(exitFullscreen);
};

// question_type	question_text	required	page_number	option_text	option_values	variables
// instruction	Welcome to this survey. Press <strong>Next</strong> to begin.	0	1
// instruction	This scale consists of a number of words and phrases that describe different feelings and emotions. Read each item and then mark the appropriate answer. Indicate to what extent you have felt this way during the <strong>past two week</strong>	0	2
// radio	Cheerful	1	3	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Disgusted	1	3	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Attentive	1	3	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Bashful	1	3	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Sluggish	1	3	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Daring	1	3	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Surprised	1	3	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Strong	1	3	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Scornful	1	3	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Relaxed	1	3	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Irritable	1	3	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Delighted	1	3	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Inspired	1	3	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Fearless	1	3	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Disgusted with self	1	3	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Sad	1	4	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Calm	1	4	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Afraid	1	4	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Tired	1	4	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Amazed	1	4	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Shaky	1	4	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Happy	1	4	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Timid	1	4	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Alone	1	4	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Alert	1	4	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Upset	1	4	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Angry	1	4	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Bold	1	4	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Blue	1	4	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Shy	1	4	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Active	1	5	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Guilty	1	5	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Joyful	1	5	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Nervous	1	5	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Lonely	1	5	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Sleepy	1	5	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Excited	1	5	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Hostile	1	5	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Proud	1	5	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Jittery	1	5	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Lively	1	5	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Ashamed	1	5	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	At ease	1	5	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Scared	1	5	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Drowsy	1	5	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Angry at self	1	6	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Enthusiastic	1	6	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Downhearted	1	6	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Sheepish	1	6	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Distressed	1	6	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Blameworthy	1	6	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Determined	1	6	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Frightened	1	6	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Astonished	1	6	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Interested	1	6	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Loathing	1	6	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Confident	1	6	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Energetic	1	6	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Concentrating	1	6	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// radio	Dissatisfied with self	1	6	"Very slightly or not at all, A little, Moderately, Quite a bit, Extremely"	"1,2,3,4,5"
// instruction	Congratulations for completing this survey! Press <strong>finish</strong> to continue.	0	7

const createSurveyQuestions = questions => {
  const firstObj = {
    type: "html",
    prompt:
      "<h2>Indicate to what extent you have felt this way during the <b>past two weeks</b>.</h2>",
    name: "Indicate to what extent you have felt this way during the past two weeks.",
  };

  var surveyQuestions = [];

  for (let i = 0; i < questions.length; i++) {
    var questionObj = {
      type: "likert",
      likert_scale_values: [
        { value: 1, text: "Very slightly or not at all" },
        { value: 2, text: "A little" },
        {
          value: 3,
          text: "Moderately",
        },
        { value: 4, text: "Quite a bit" },
        { value: 5, text: "Extremely" },
      ],
      prompt: `${questions[i]}`,
      name: `${questions[i]}`,
      required: true,
    };
    surveyQuestions.push(questionObj);
  }

  function chunkArray(array, chunkSize, prependedObj) {
    let result = [];
    for (let i = 0; i < array.length; i += chunkSize) {
      let chunk = array.slice(i, i + chunkSize);
      chunk.unshift(prependedObj); // Add the object to the start of each chunk
      result.push(chunk);
    }
    return result;
  }
  // this won't chunk the array b/c questions.length, but keeping in case we want to split up questions into different pages
  var preparedQuestionArray = chunkArray(
    surveyQuestions,
    questions.length,
    firstObj
  );

  return preparedQuestionArray;
};

var questions = [
  "Cheerful",
  "Disgusted",
  "Attentive",
  "Bashful",
  "Sluggish",
  "Daring",
  "Surprised",
  "Strong",
  "Scornful",
  "Relaxed",
  "Irritable",
  "Delighted",
  "Inspired",
  "Fearless",
  "Disgusted with self",
  "Sad",
  "Calm",
  "Afraid",
  "Tired",
  "Amazed",
  "Shaky",
  "Happy",
  "Timid",
  "Alone",
  "Alert",
  "Upset",
  "Angry",
  "Bold",
  "Blue",
  "Shy",
  "Active",
  "Guilty",
  "Joyful",
  "Nervous",
  "Lonely",
  "Sleepy",
  "Excited",
  "Hostile",
  "Proud",
  "Jittery",
  "Lively",
  "Ashamed",
  "At ease",
  "Scared",
  "Drowsy",
  "Angry at self",
  "Enthusiastic",
  "Downhearted",
  "Sheepish",
  "Distressed",
  "Blameworthy",
  "Determined",
  "Frightened",
  "Astonished",
  "Interested",
  "Loathing",
  "Confident",
  "Energetic",
  "Concentrating",
  "Dissatisfied with self",
];

var surveyQuestions = createSurveyQuestions(questions);

var instructions = [
  `<div class='instructions'>
      <p>Welcome to this survey.</p>
      <p>This scale consists of a number of words and phrases that describe different feelings and emotions. Read each item and then mark the appropriate answer. Indicate to what extent you have felt this way during the <b>past two weeks</b>.</p>
      <p>Press <b>enter</b> to begin.</p>
  </div>`,
];

var instructionsBlock = {
  type: jsPsychHtmlKeyboardResponse,
  data: {
    trial_id: "instructions",
    trial_duration: 180000,
  },
  trial_duration: 180000,
  stimulus: instructions,
  choices: ["Enter"],
  post_trial_gap: 0,
};
var trial = {
  type: jsPsychSurvey,
  pages: surveyQuestions,
  button_label_finish: "Submit",
  on_finish: function (data) {
    if (
      "Indicate to what extent you have felt this way during the past two weeks." in
      data.response
    ) {
      delete data.response[
        "Indicate to what extent you have felt this way during the past two weeks."
      ];
    }
    data.likert_scale_1_label = "Very slightly or not at all";
    data.likert_scale_2_label = "A little";
    data.likert_scale_3_label = "Moderately";
    data.likert_scale_4_label = "Quite a bit";
    data.likert_scale_5_label = "Extremely";
    
    Object.keys(data.response).forEach(function (key) {
      data[key] = {
        key: key,
        response: data.response[key],
      };
    });
  },
};

var postTaskQuestion =
  "Do you have any comments, concerns, or issues pertaining to this survey?";

var postTaskBlock = {
  type: jsPsychSurveyText,
  questions: [
    {
      prompt: `<h1 class=block-text>${postTaskQuestion}</h1>`,
      name: postTaskQuestion,
      required: false,
      rows: 20,
      columns: 80,
    },
  ],
  response_ends_trial: true,
  data: {
    trial_id: "post_task_feedback",
  },
  on_finish: function (data) {
    data.question = postTaskQuestion;
    data.response = data.response[postTaskQuestion];
  },
};

var fullscreen = {
  type: jsPsychFullscreen,
  fullscreen_mode: true,
};
var exitFullscreen = {
  type: jsPsychFullscreen,
  fullscreen_mode: false,
};

var endText = `
  <div class="centerbox">
    <p class="center-block-text">Thanks for completing this task!</p>
    <p class="center-block-text">Press <i>enter</i> to continue.</p>
  </div>
`;

var endBlock = {
  type: jsPsychHtmlKeyboardResponse,
  data: {
    trial_id: "end",
    exp_id: "panas_last_two_weeks_survey_rdoc",
    trial_duration: 180000,
  },
  trial_duration: 180000,
  stimulus: endText,
  choices: ["Enter"],
  post_trial_gap: 0,
};

panas_last_two_weeks_survey_rdoc_experiment = [];
var panas_last_two_weeks_survey_rdoc_init = () => {
  panas_last_two_weeks_survey_rdoc_experiment.push(fullscreen);
  panas_last_two_weeks_survey_rdoc_experiment.push(instructionsBlock);
  panas_last_two_weeks_survey_rdoc_experiment.push(trial);
  panas_last_two_weeks_survey_rdoc_experiment.push(postTaskBlock);
  panas_last_two_weeks_survey_rdoc_experiment.push(endBlock);
  panas_last_two_weeks_survey_rdoc_experiment.push(exitFullscreen);
};

// question_type	question_text	required	page_number	option_text	option_values
// instruction	Welcome to this survey. Press <strong>Next</strong> to begin.	0	1
// instruction	In the following pages you will be presented with a number of statements that describe ways in which people act and think. For each statement, please indicate how much you agree or disagree with the statement.	0	2
// radio	I have a reserved and cautious attitude toward life.	1	3	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	I have trouble controlling my impulses.	1	3	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I generally seek new and exciting experiences and sensations.	1	3	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I generally like to see things through to the end.	1	3	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	When I am very happy, I can’t seem to stop myself from doing things that can have bad consequences.	1	3	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	My thinking is usually careful and purposeful.	1	3	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	I have trouble resisting my cravings (for food, cigarettes, etc.).	1	3	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I'll try anything once.	1	3	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I tend to give up easily.	1	3	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	When I am in great mood, I tend to get into situations that could cause me problems.	1	3	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I am not one of those people who blurt out things without thinking.	1	3	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	I often get involved in things I later wish I could get out of.	1	3	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I like sports and games in which you have to choose your next move very quickly.	1	3	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	Unfinished tasks really bother me.	1	3	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	When I am very happy, I tend to do things that may cause problems in my life.	1	3	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I like to stop and think things over before I do them.	1	4	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	When I feel bad, I will often do things I later regret in order to make myself feel better now.	1	4	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I would enjoy water skiing.	1	4	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	Once I get going on something I hate to stop.	1	4	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	I tend to lose control when I am in a great mood.	1	4	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I don't like to start a project until I know exactly how to proceed.	1	4	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	Sometimes when I feel bad, I can't seem to stop what I am doing even though it is making me feel worse.	1	4	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I quite enjoy taking risks.	1	4	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I concentrate easily.	1	4	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	When I am really ecstatic, I tend to get out of control.	1	4	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I would enjoy parachute jumping.	1	4	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I finish what I start.	1	4	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	I tend to value and follow a rational, 'sensible' approach to things.	1	4	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	When I am upset I often act without thinking.	1	4	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	Others would say I make bad choices when I am extremely happy about something.	1	4	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I welcome new and exciting experiences and sensations, even if they are a little frightening and unconventional.	1	5	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I am able to pace myself so as to get things done on time.	1	5	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	I usually make up my mind through careful reasoning.	1	5	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	When I feel rejected, I will often say things that I later regret. 	1	5	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	Others are shocked or worried about the things I do when I am feeling very excited. 	1	5	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I would like to learn to fly an airplane. 	1	5	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I am a person who always gets the job done. 	1	5	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	I am a cautious person. 	1	5	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	It is hard for me to resist acting on my feelings. 	1	5	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	When I get really happy about something, I tend to do things that can have bad consequences. 	1	5	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I sometimes like doing things that are a bit frightening. 	1	5	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I almost always finish projects that I start. 	1	5	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	Before I get into a new situation I like to find out what to expect from it. 	1	5	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	I often make matters worse because I act without thinking when I am upset.	1	5	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	When overjoyed, I feel like I can’t stop myself from going overboard.	1	5	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I would enjoy the sensation of skiing very fast down a high mountain slope.	1	6	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	Sometimes there are so many little things to be done that I just ignore them all.	1	6	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I usually think carefully before doing anything.	1	6	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	When I am really excited, I tend not to think of the consequences of my actions.	1	6	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	In the heat of an argument, I will often say things that I later regret.	1	6	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I would like to go scuba diving.	1	6	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I tend to act without thinking when I am really excited.	1	6	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I always keep my feelings under control.	1	6	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	When I am really happy, I often find myself in situations that I normally wouldn't be comfortable with.	1	6	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	Before making up my mind, I consider all the advantages and disadvantages.	1	6	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	1,2,3,4
// radio	I would enjoy fast driving.	1	6	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	When I am very happy, I feel like it is ok to give in to cravings or overindulge.	1	6	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	Sometimes I do impulsive things that I later regret.	1	6	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// radio	I am surprised at the things I do while in a great mood.	1	6	Agree Strongly,Agree Some,Disagree Some,Disagree Strongly	4,3,2,1
// instruction	Congratulations for completing this survey! Press <strong>finish</strong> to continue.	0	7

const createSurveyQuestions = questions => {
  const firstObj = {
    type: "html",
    prompt:
      "<h2>Indicate how much you agree or disagree with the statement.</h2>",
    name: "Indicate how much you agree or disagree with the statement.",
  };

  var surveyQuestions = [];

  for (let i = 0; i < questions.length; i++) {
    var questionObj = {
      type: "likert",
      likert_scale_values: [
        {
          value: 1,
          text: "Disagree Strongly",
        },
        { value: 2, text: "Disagree Some" },
        {
          value: 3,
          text: "Agree Some",
        },
        { value: 4, text: "Agree Strongly" },
      ],
      prompt: `${questions[i].question}`,
      name: `${questions[i].question}`,
      required: true,
    };
    surveyQuestions.push(questionObj);
  }

  function chunkArray(array, chunkSize, prependedObj) {
    let result = [];
    for (let i = 0; i < array.length; i += chunkSize) {
      let chunk = array.slice(i, i + chunkSize);
      chunk.unshift(prependedObj); // Add the object to the start of each chunk
      result.push(chunk);
    }
    return result;
  }

  var preparedQuestionArray = chunkArray(surveyQuestions, 20, firstObj);

  return preparedQuestionArray;
};

var questions = [
  {
    key: "reserved_cautious_attitude",
    question: "I have a reserved and cautious attitude toward life.",
  },
  {
    key: "trouble_controlling_impulses",
    question: "I have trouble controlling my impulses.",
  },
  {
    key: "seek_new_experiences",
    question: "I generally seek new and exciting experiences and sensations.",
  },
  {
    key: "see_things_to_end",
    question: "I generally like to see things through to the end.",
  },
  {
    key: "overact_when_happy",
    question:
      "When I am very happy, I can’t seem to stop myself from doing things that can have bad consequences.",
  },
  {
    key: "careful_thinking",
    question: "My thinking is usually careful and purposeful.",
  },
  {
    key: "trouble_resisting_cravings",
    question:
      "I have trouble resisting my cravings (for food, cigarettes, etc.).",
  },
  { key: "try_anything_once", question: "I'll try anything once." },
  { key: "give_up_easily", question: "I tend to give up easily." },
  {
    key: "problems_when_in_good_mood",
    question:
      "When I am in great mood, I tend to get into situations that could cause me problems.",
  },
  {
    key: "not_blurt_out",
    question:
      "I am not one of those people who blurt out things without thinking.",
  },
  {
    key: "regret_involvements",
    question: "I often get involved in things I later wish I could get out of.",
  },
  {
    key: "like_quick_decision_sports",
    question:
      "I like sports and games in which you have to choose your next move very quickly.",
  },
  {
    key: "bothered_by_unfinished_tasks",
    question: "Unfinished tasks really bother me.",
  },
  {
    key: "happy_causes_problems",
    question:
      "When I am very happy, I tend to do things that may cause problems in my life.",
  },
  {
    key: "stop_think_before_acting",
    question: "I like to stop and think things over before I do them.",
  },
  {
    key: "act_regret_when_sad",
    question:
      "When I feel bad, I will often do things I later regret in order to make myself feel better now.",
  },
  { key: "enjoy_water_skiing", question: "I would enjoy water skiing." },
  {
    key: "hate_to_stop_once_started",
    question: "Once I get going on something I hate to stop.",
  },
  {
    key: "lose_control_good_mood",
    question: "I tend to lose control when I am in a great mood.",
  },
  {
    key: "not_start_until_ready",
    question:
      "I don't like to start a project until I know exactly how to proceed.",
  },
  {
    key: "feel_worse_cant_stop",
    question:
      "Sometimes when I feel bad, I can't seem to stop what I am doing even though it is making me feel worse.",
  },
  { key: "enjoy_taking_risks", question: "I quite enjoy taking risks." },
  { key: "concentrate_easily", question: "I concentrate easily." },
  {
    key: "out_of_control_when_ecstatic",
    question: "When I am really ecstatic, I tend to get out of control.",
  },
  {
    key: "enjoy_parachute_jumping",
    question: "I would enjoy parachute jumping.",
  },
  { key: "finish_what_start", question: "I finish what I start." },
  {
    key: "value_rational_approach",
    question:
      "I tend to value and follow a rational, 'sensible' approach to things.",
  },
  {
    key: "act_without_thinking_when_upset",
    question: "When I am upset I often act without thinking.",
  },
  {
    key: "bad_choices_when_extremely_happy",
    question:
      "Others would say I make bad choices when I am extremely happy about something.",
  },
  {
    key: "welcome_new_experiences",
    question:
      "I welcome new and exciting experiences and sensations, even if they are a little frightening and unconventional.",
  },
  {
    key: "pace_to_meet_deadlines",
    question: "I am able to pace myself so as to get things done on time.",
  },
  {
    key: "careful_decision_making",
    question: "I usually make up my mind through careful reasoning.",
  },
  {
    key: "regret_sayings_when_rejected",
    question:
      "When I feel rejected, I will often say things that I later regret.",
  },
  {
    key: "shocked_by_actions_when_excited",
    question:
      "Others are shocked or worried about the things I do when I am feeling very excited.",
  },
  {
    key: "learn_to_fly",
    question: "I would like to learn to fly an airplane.",
  },
  {
    key: "always_get_job_done",
    question: "I am a person who always gets the job done.",
  },
  { key: "am_cautious", question: "I am a cautious person." },
  {
    key: "hard_resist_acting_on_feelings",
    question: "It is hard for me to resist acting on my feelings.",
  },
  {
    key: "bad_consequences_when_happy",
    question:
      "When I get really happy about something, I tend to do things that can have bad consequences.",
  },
  {
    key: "like_frightening_things",
    question: "I sometimes like doing things that are a bit frightening.",
  },
  {
    key: "almost_always_finish_projects",
    question: "I almost always finish projects that I start.",
  },
  {
    key: "like_to_know_what_to_expect",
    question:
      "Before I get into a new situation I like to find out what to expect from it.",
  },
  {
    key: "make_things_worse_when_upset",
    question:
      "I often make matters worse because I act without thinking when I am upset.",
  },
  {
    key: "cant_stop_overboard_when_joyful",
    question:
      "When overjoyed, I feel like I can’t stop myself from going overboard.",
  },
  {
    key: "enjoy_fast_skiing",
    question:
      "I would enjoy the sensation of skiing very fast down a high mountain slope.",
  },
  {
    key: "ignore_small_tasks",
    question:
      "Sometimes there are so many little things to be done that I just ignore them all.",
  },
  {
    key: "think_carefully_before_acting",
    question: "I usually think carefully before doing anything.",
  },
  {
    key: "not_think_of_consequences_when_excited",
    question:
      "When I am really excited, I tend not to think of the consequences of my actions.",
  },
  {
    key: "say_regrettable_things_in_arguments",
    question:
      "In the heat of an argument, I will often say things that I later regret.",
  },
  { key: "want_to_scuba_dive", question: "I would like to go scuba diving." },
  {
    key: "act_without_thinking_excited",
    question: "I tend to act without thinking when I am really excited.",
  },
  {
    key: "keep_feelings_under_control",
    question: "I always keep my feelings under control.",
  },
  {
    key: "situations_not_comfortable_when_happy",
    question:
      "When I am really happy, I often find myself in situations that I normally wouldn't be comfortable with.",
  },
  {
    key: "consider_pros_cons_before_decision",
    question:
      "Before making up my mind, I consider all the advantages and disadvantages.",
  },
  { key: "enjoy_fast_driving", question: "I would enjoy fast driving." },
  {
    key: "give_in_to_cravings_when_happy",
    question:
      "When I am very happy, I feel like it is ok to give in to cravings or overindulge.",
  },
  {
    key: "impulsive_regrets",
    question: "Sometimes I do impulsive things that I later regret.",
  },
  {
    key: "surprised_by_own_actions_in_mood",
    question: "I am surprised at the things I do while in a great mood.",
  },
];

var surveyQuestions = createSurveyQuestions(questions);

var instructions = [
  `<div class='instructions'>
      <p>Welcome to this survey.</p>
      <p>In the following pages, you will be presented with a number of statements that describe ways in which people act and think. For each statement, please indicate how much you agree or disagree with the statement.</p>
      <p>Press <b>enter</b> to begin.</p>
  </div>`,
];

var instructionsBlock = {
  type: jsPsychHtmlKeyboardResponse,
  data: {
    trial_id: "instructions",
    trial_duration: 180000,
  },
  trial_duration: 180000,
  stimulus: instructions,
  choices: ["Enter"],
  post_trial_gap: 0,
};
var trial = {
  type: jsPsychSurvey,
  pages: surveyQuestions,
  button_label_finish: "Submit",
  on_finish: function (data) {
    if (
      "Indicate how much you agree or disagree with the statement." in
      data.response
    ) {
      delete data.response[
        "Indicate how much you agree or disagree with the statement."
      ];
    }
    data.likert_scale_1_label = "Disagree strongly";
    data.likert_scale_2_label = "Disagree some";
    data.likert_scale_3_label = "Agree some";
    data.likert_scale_4_label = "Agree strongly";

    var questionKeys = {};
    questions.forEach(function (q) {
      questionKeys[q.question] = q.key;
    });

    for (var question in data.response) {
      var key = questionKeys[question];
      if (key) {
        data[key] = {
          response: data.response[question],
          question: question,
          key: key,
        };
      }
    }
  },
};

var postTaskQuestion =
  "Do you have any comments, concerns, or issues pertaining to this survey?";

var postTaskBlock = {
  type: jsPsychSurveyText,
  questions: [
    {
      prompt: `<h1 class=block-text>${postTaskQuestion}</h1>`,
      name: postTaskQuestion,
      required: false,
      rows: 20,
      columns: 80,
    },
  ],
  response_ends_trial: true,
  data: {
    trial_id: "post_task_feedback",
  },
  on_finish: function (data) {
    data.question = postTaskQuestion;
    data.response = data.response[postTaskQuestion];
  },
};

var fullscreen = {
  type: jsPsychFullscreen,
  fullscreen_mode: true,
};
var exitFullscreen = {
  type: jsPsychFullscreen,
  fullscreen_mode: false,
};

var endText = `
  <div class="centerbox">
    <p class="center-block-text">Thanks for completing this task!</p>
    <p class="center-block-text">Press <i>enter</i> to continue.</p>
  </div>
`;

var endBlock = {
  type: jsPsychHtmlKeyboardResponse,
  data: {
    trial_id: "end",
    exp_id: "upps_impulsivity_survey_rdoc",
    trial_duration: 180000,
  },
  trial_duration: 180000,
  stimulus: endText,
  choices: ["Enter"],
  post_trial_gap: 0,
};

upps_impulsivity_survey_rdoc_experiment = [];
var upps_impulsivity_survey_rdoc_init = () => {
  upps_impulsivity_survey_rdoc_experiment.push(fullscreen);
  upps_impulsivity_survey_rdoc_experiment.push(instructionsBlock);
  upps_impulsivity_survey_rdoc_experiment.push(trial);
  upps_impulsivity_survey_rdoc_experiment.push(postTaskBlock);
  upps_impulsivity_survey_rdoc_experiment.push(endBlock);
  upps_impulsivity_survey_rdoc_experiment.push(exitFullscreen);
};

// question_type	question_text	required	page_number	option_text	option_values
// instruction	Welcome to this survey. Press <strong>Next</strong> to begin.	0	1
// instruction	For each of the following statements, please indicate the <strong>likelihood</strong> that you would engage in the described activity or behavior if you were to find yourself in that situation.	0	2
// radio	Admitting that your tastes are different from those of a friend.	1	3	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Going camping in the wilderness.	1	3	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Betting a day's income at the horse races.	1	3	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Investing 10% of your annual income in a moderate growth diversified fund.	1	3	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Drinking heavily at a social function.	1	3	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Taking some questionable deductions on your income tax return.	1	3	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Disagreeing with an authority figure on a major issue.	1	4	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Betting a day's income at a high-stake poker game.	1	4	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Having an affair with a married man/woman.	1	4	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Passing off somebody else’s work as your own.	1	4	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Going down a ski run that is beyond your ability.	1	4	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Investing 5% of your annual income in a very speculative stock.	1	4	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Going whitewater rafting at high water in the spring.	1	5	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Betting a day's income on the outcome of a sporting event.	1	5	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Engaging in unprotected sex.	1	5	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Revealing a friend's secret to someone else.	1	5	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Driving a car without wearing a seat belt.	1	5	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Investing 10% of your annual income in a new business venture.	1	5	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Taking a skydiving class.	1	6	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Riding a motorcycle without a helmet.	1	6	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Choosing a career that you truly enjoy over a more secure one.	1	6	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Speaking your mind about an unpopular issue in a meeting at work.	1	6	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Sunbathing without sunscreen.	1	6	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Bungee jumping off a tall bridge.	1	6	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Piloting a small plane.	1	7	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Walking home alone at night in an unsafe area of town.	1	7	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Moving to a city far away from your extended family.	1	7	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Starting a new career in your mid-thirties.	1	7	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Leaving your young children alone at home while running an errand.	1	7	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// radio	Not returning a wallet you found that contains $200.	1	7	Extremely Unlikely,Moderately Unlikely,Somewhat Unlikely,Not Sure,Somewhat Likely,Moderately Likely,Extremely Likely	1,2,3,4,5,6,7
// instruction	Congratulations for completing this survey! Press < strong > finish</strong > to continue.0	8

const createSurveyQuestions = questions => {
  const firstObj = {
    type: "html",
    prompt:
      "<h2>Indicate the <b>likelihood</b> that you would engage in the described activity or behavior if you were to find yourself in that situation.</h2>",
    name: "Indicate the likelihood that you would engage in the described activity or behavior if you were to find yourself in that situation.",
  };

  var surveyQuestions = [];

  for (let i = 0; i < questions.length; i++) {
    var questionObj = {
      type: "likert",
      likert_scale_values: [
        { value: 1, text: "Extremely Unlikely" },
        { value: 2, text: "Moderately Unlikely" },
        {
          value: 3,
          text: "Somewhat Unlikely",
        },
        { value: 4, text: "Not Sure" },
        { value: 5, text: "Somewhat Likely" },
        { value: 6, text: "Moderately Likely" },

        { value: 7, text: "Extremely Likely" },
      ],
      prompt: `${questions[i]}`,
      name: `${questions[i]}`,
      required: true,
    };
    surveyQuestions.push(questionObj);
  }

  function chunkArray(array, chunkSize, prependedObj) {
    let result = [];
    for (let i = 0; i < array.length; i += chunkSize) {
      let chunk = array.slice(i, i + chunkSize);
      chunk.unshift(prependedObj); // Add the object to the start of each chunk
      result.push(chunk);
    }
    return result;
  }

  // this won't chunk the array b/c questions.length, but keeping in case we want to split up questions into different pages
  var preparedQuestionArray = chunkArray(
    surveyQuestions,
    questions.length,
    firstObj
  );

  return preparedQuestionArray;
};

var questions = [
  "Admitting that your tastes are different from those of a friend.",
  "Going camping in the wilderness.",
  "Betting a day's income at the horse races.",
  "Investing 10% of your annual income in a moderate growth diversified fund.",
  "Drinking heavily at a social function.",
  "Taking some questionable deductions on your income tax return.",
  "Disagreeing with an authority figure on a major issue.",
  "Betting a day's income at a high-stake poker game.",
  "Having an affair with a married man/woman.",
  "Passing off somebody else’s work as your own.",
  "Going down a ski run that is beyond your ability.",
  "Investing 5% of your annual income in a very speculative stock.",
  "Going whitewater rafting at high water in the spring.",
  "Betting a day's income on the outcome of a sporting event.",
  "Engaging in unprotected sex.",
  "Revealing a friend's secret to someone else.",
  "Driving a car without wearing a seat belt.",
  "Investing 10% of your annual income in a new business venture.",
  "Taking a skydiving class.",
  "Riding a motorcycle without a helmet.",
  "Choosing a career that you truly enjoy over a more secure one.",
  "Speaking your mind about an unpopular issue in a meeting at work.",
  "Sunbathing without sunscreen.",
  "Bungee jumping off a tall bridge.",
  "Piloting a small plane.",
  "Walking home alone at night in an unsafe area of town.",
  "Moving to a city far away from your extended family.",
  "Starting a new career in your mid-thirties.",
  "Leaving your young children alone at home while running an errand.",
  "Not returning a wallet you found that contains $200.",
];

var surveyQuestions = createSurveyQuestions(questions);

var instructions = [
  `<div class='instructions'>
      <p>Welcome to this survey.</p>
      <p>For each of the following statements, please indicate the <b>likelihood</b> that you would engage in the described activity or behavior if you were to find yourself in that situation.</p>
      <p>Press <b>enter</b> to begin.</p>
  </div>`,
];

var instructionsBlock = {
  type: jsPsychHtmlKeyboardResponse,
  data: {
    trial_id: "instructions",
    trial_duration: 180000,
  },
  trial_duration: 180000,
  stimulus: instructions,
  choices: ["Enter"],
  post_trial_gap: 0,
};
var trial = {
  type: jsPsychSurvey,
  pages: surveyQuestions,
  button_label_finish: "Submit",
  on_finish: function (data) {
    if (
      "Indicate the likelihood that you would engage in the described activity or behavior if you were to find yourself in that situation." in
      data.response
    ) {
      delete data.response[
        "Indicate the likelihood that you would engage in the described activity or behavior if you were to find yourself in that situation."
      ];
    }
    data.likert_scale_1_label = "Extremely Unlikely";
    data.likert_scale_2_label = "Moderately Unlikely";
    data.likert_scale_3_label = "Somewhat Unlikely";
    data.likert_scale_4_label = "Not Sure";
    data.likert_scale_5_label = "Somewhat Likely";
    data.likert_scale_6_label = "Moderately Likely";
    data.likert_scale_7_label = "Extremely Likely";
  },
};

var postTaskQuestion =
  "Do you have any comments, concerns, or issues pertaining to this survey?";

var postTaskBlock = {
  type: jsPsychSurveyText,
  questions: [
    {
      prompt: `<h1 class=block-text>${postTaskQuestion}</h1>`,
      name: postTaskQuestion,
      required: false,
      rows: 20,
      columns: 80,
    },
  ],
  response_ends_trial: true,
  data: {
    trial_id: "post_task_feedback",
  },
  on_finish: function (data) {
    data.question = postTaskQuestion;
    data.response = data.response[postTaskQuestion];
  },
};

var fullscreen = {
  type: jsPsychFullscreen,
  fullscreen_mode: true,
};
var exitFullscreen = {
  type: jsPsychFullscreen,
  fullscreen_mode: false,
};

var endText = `
  <div class="centerbox">
    <p class="center-block-text">Thanks for completing this task!</p>
    <p class="center-block-text">Press <i>enter</i> to continue.</p>
  </div>
`;

var endBlock = {
  type: jsPsychHtmlKeyboardResponse,
  data: {
    trial_id: "end",
    exp_id: "dospert_rt_survey_rdoc",
    trial_duration: 180000,
  },
  trial_duration: 180000,
  stimulus: endText,
  choices: ["Enter"],
  post_trial_gap: 0,
};

dospert_rt_survey_rdoc_experiment = [];
var dospert_rt_survey_rdoc_init = () => {
  dospert_rt_survey_rdoc_experiment.push(fullscreen);
  dospert_rt_survey_rdoc_experiment.push(instructionsBlock);
  dospert_rt_survey_rdoc_experiment.push(trial);
  dospert_rt_survey_rdoc_experiment.push(postTaskBlock);
  dospert_rt_survey_rdoc_experiment.push(endBlock);
  dospert_rt_survey_rdoc_experiment.push(exitFullscreen);
};
